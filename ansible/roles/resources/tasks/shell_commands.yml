---

- name: '{{ item.name }}'
  shell: '{{ item.script | d(item.shell | d(item.command)) }}'  # noqa 305
  args:
    chdir:      '{{ item.chdir      | d(omit) }}'
    creates:    '{{ item.creates    | d(omit) }}'
    removes:    '{{ item.removes    | d(omit) }}'
    executable: '{{ item.executable | d("bash") }}'
  when: item.name|d() and item.state not in [ 'absent', 'ignore' ]
  no_log: '{{ item.no_log | d(False) }}'

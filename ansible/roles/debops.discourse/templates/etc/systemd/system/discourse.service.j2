# {{ ansible_managed }}

[Unit]
Description=Discourse Unicorn Server
Requires=redis-server.service
Wants=postgresql.service
After=redis-server.service postgresql.service

[Service]
Environment="HOME={{ discourse_home }}"
Environment=USER={{ discourse_user }}
EnvironmentFile={{ discourse_git_checkout + "/environment.txt" }}
User={{ discourse_user }}
WorkingDirectory={{ discourse_git_checkout }}
SyslogIdentifier=discourse
PIDFile={{ discourse_git_checkout }}/tmp/pids/unicorn.pid

ExecStart=/usr/bin/bundle exec "config/unicorn_launcher -E production -c config/unicorn.conf.rb"

[Install]
WantedBy=multi-user.target

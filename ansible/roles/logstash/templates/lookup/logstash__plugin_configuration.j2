{# Copyright (C) 2020 Pedro Luis Lopez <pedroluis.lopezsanchez@gmail.com>
 # Copyright (C) 2020 DebOps <https://debops.org/>
 # SPDX-License-Identifier: GPL-3.0-only
 #}
{% set logstash__tpl_output = [] %}
{% for plugin in ([ logstash__combined_plugins ] if logstash__combined_plugins is mapping else logstash__combined_plugins) %}
{%   if plugin.state|d('present') != 'absent' %}
{%     if plugin.configuration|d() %}
{%       set _ = logstash__tpl_output.append(plugin.configuration) %}
{%     elif plugin.config|d() %}
{%       set _ = logstash__tpl_output.append(plugin.config) %}
{%     endif %}
{%   endif %}
{% endfor %}
{{ logstash__tpl_output | to_yaml }}
